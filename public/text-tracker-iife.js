!function(){"use strict";var e;let t,n;function l(l,i){if(l.nodeType!==Node.ELEMENT_NODE)throw new Error("Can't generate CSS selector for non-element node type.");if("html"===l.tagName.toLowerCase())return"html";const r={root:document.body,idName:e=>!0,className:e=>!0,tagName:e=>!0,attr:(e,t)=>!1,seedMinLength:1,optimizedMinLength:2,threshold:1e3,maxNumberOfTries:1e4};t=Object.assign(Object.assign({},r),i),n=function(e,t){if(e.nodeType===Node.DOCUMENT_NODE)return e;if(e===t.root)return e.ownerDocument;return e}(t.root,r);let c=o(l,e.All,(()=>o(l,e.Two,(()=>o(l,e.One)))));if(c){const e=y(w(c,l));return e.length>0&&(c=e[0]),s(c)}throw new Error("Selector was not found.")}function o(n,l,o){let s=null,r=[],c=n,E=0;for(;c&&c!==t.root.parentElement;){let n=p(a(c))||p(...d(c))||p(...u(c))||p(h(c))||[{name:"*",penalty:3}];const x=m(c);if(l===e.All)x&&(n=n.concat(n.filter(g).map((e=>f(e,x)))));else if(l===e.Two)n=n.slice(0,1),x&&(n=n.concat(n.filter(g).map((e=>f(e,x)))));else if(l===e.One){const[e]=n=n.slice(0,1);x&&g(e)&&(n=[f(e,x)])}for(let e of n)e.level=E;if(r.push(n),r.length>=t.seedMinLength&&(s=i(r,o),s))break;c=c.parentElement,E++}return s||(s=i(r,o)),s}function i(e,n){const l=y(x(e));if(l.length>t.threshold)return n?n():null;for(let e of l)if(c(e))return e;return null}function s(e){let t=e[0],n=t.name;for(let l=1;l<e.length;l++){const o=e[l].level||0;n=t.level===o-1?`${e[l].name} > ${n}`:`${e[l].name} ${n}`,t=e[l]}return n}function r(e){return e.map((e=>e.penalty)).reduce(((e,t)=>e+t),0)}function c(e){switch(n.querySelectorAll(s(e)).length){case 0:throw new Error(`Can't select any node with this selector: ${s(e)}`);case 1:return!0;default:return!1}}function a(e){const n=e.getAttribute("id");return n&&t.idName(n)?{name:"#"+v(n,{isIdentifier:!0}),penalty:0}:null}function d(e){const n=Array.from(e.attributes).filter((e=>t.attr(e.name,e.value)));return n.map((e=>({name:"["+v(e.name,{isIdentifier:!0})+'="'+v(e.value)+'"]',penalty:.5})))}function u(e){return Array.from(e.classList).filter(t.className).map((e=>({name:"."+v(e,{isIdentifier:!0}),penalty:1})))}function h(e){const n=e.tagName.toLowerCase();return t.tagName(n)?{name:n,penalty:2}:null}function m(e){const t=e.parentNode;if(!t)return null;let n=t.firstChild;if(!n)return null;let l=0;for(;n&&(n.nodeType===Node.ELEMENT_NODE&&l++,n!==e);)n=n.nextSibling;return l}function f(e,t){return{name:e.name+`:nth-child(${t})`,penalty:e.penalty+1}}function g(e){return"html"!==e.name&&!e.name.startsWith("#")}function p(...e){const t=e.filter(E);return t.length>0?t:null}function E(e){return null!=e}function*x(e,t=[]){if(e.length>0)for(let n of e[0])yield*x(e.slice(1,e.length),t.concat(n));else yield t}function y(e){return Array.from(e).sort(((e,t)=>r(e)-r(t)))}function*w(e,n,l={counter:0,visited:new Map}){if(e.length>2&&e.length>t.optimizedMinLength)for(let o=1;o<e.length-1;o++){if(l.counter>t.maxNumberOfTries)return;l.counter+=1;const i=[...e];i.splice(o,1);const r=s(i);if(l.visited.has(r))return;c(i)&&T(i,n)&&(yield i,l.visited.set(r,!0),yield*w(i,n,l))}}function T(e,t){return n.querySelector(s(e))===t}!function(e){e[e.All=0]="All",e[e.Two=1]="Two",e[e.One=2]="One"}(e||(e={}));const b=/[ -,\.\/:-@\[-\^`\{-~]/,_=/[ -,\.\/:-@\[\]\^`\{-~]/,L=/(^|\\+)?(\\[A-F0-9]{1,6})\x20(?![a-fA-F0-9\x20])/g,S={escapeEverything:!1,isIdentifier:!1,quotes:"single",wrap:!1};function v(e,t={}){const n=Object.assign(Object.assign({},S),t);"single"!=n.quotes&&"double"!=n.quotes&&(n.quotes="single");const l="double"==n.quotes?'"':"'",o=n.isIdentifier,i=e.charAt(0);let s="",r=0;const c=e.length;for(;r<c;){const t=e.charAt(r++);let i,a=t.charCodeAt(0);if(a<32||a>126){if(a>=55296&&a<=56319&&r<c){const t=e.charCodeAt(r++);56320==(64512&t)?a=((1023&a)<<10)+(1023&t)+65536:r--}i="\\"+a.toString(16).toUpperCase()+" "}else i=n.escapeEverything?b.test(t)?"\\"+t:"\\"+a.toString(16).toUpperCase()+" ":/[\t\n\f\r\x0B]/.test(t)?"\\"+a.toString(16).toUpperCase()+" ":"\\"==t||!o&&('"'==t&&l==t||"'"==t&&l==t)||o&&_.test(t)?"\\"+t:t;s+=i}return o&&(/^-[-\d]/.test(s)?s="\\-"+s.slice(1):/\d/.test(i)&&(s="\\3"+i+" "+s.slice(1))),s=s.replace(L,(function(e,t,n){return t&&t.length%2?e:(t||"")+n})),!o&&n.wrap?l+s+l:s}const N=document.createElement("template");N.innerHTML='\n  <style>\n    :host {\n      box-sizing: border-box;\n      padding: 15px;\n      width: 320px;\n      border: 2px solid darkgray;\n      box-shadow: gray 2px 2px 8px;\n      background-color: white;\n      position: absolute;\n      right: 30px;\n      top: 30px;\n      z-index: 99999;\n    }\n\n    code {\n      display: block;\n      max-width: 280px;\n    }\n\n    #selected-text {\n      max-height: 60px;\n      overflow: scroll;\n      border: 1px solid lightgray;\n      padding: 5px;\n      margin-bottom: 10px;\n    }\n  </style>\n  <div>\n        <h1>Text Tracker</h1>\n        <details>\n          <summary>Instructions</summary>\n          <ol>\n            <li>\n              Select some text or focus on something (like a form field) on the\n              screen\n            </li>\n            <li>Press the Track button</li>\n            <li>\n              If the correct text is not showing up, try selecting something\n              else on the page and coming back to what you want to track\n            </li>\n          </ol>\n        </details>\n\n        <h2>Selected text</h2> \n        <div id="selected-text"><em>no text selected, yet</em></div>\n\n        <button type="button" id="track">Track</button>\n      </div>';class k extends HTMLElement{constructor(){super(),this._selection=null,this._selectedElement=null,this._selector="",this.attachShadow({mode:"open"})}connectedCallback(){this.shadowRoot.appendChild(N.content.cloneNode(!0)),this.shadowRoot.getElementById("track").addEventListener("click",(()=>this.trackSelectedText()),!0),document.addEventListener("click",(e=>this.handleSelection(e)))}disconnectedCallback(){document.removeEventListener("click",(e=>this.handleSelection(e)))}handleSelection(e){console.log({e:e}),"text-tracker"!==e.target.nodeName.toLowerCase()&&(this._selectedElement&&(this._selectedElement.style.outline=null),this._selection=e.target,this._selectedElement=e.target,this._selectedElement?(this._selectedElement.style.outlineWidth="2px",this._selectedElement.style.outlineStyle="dotted",this._selectedElement.style.outlineColor="blue",this.shadowRoot.getElementById("selected-text").innerHTML=this.getSelectedText()):this.shadowRoot.getElementById("selected-text").innerHTML=this.getSelectedText())}getSelectedText(){if(this._selectedElement instanceof HTMLSelectElement)return`<code>${this._selectedElement.value}</code>`;if(this._selectedElement instanceof HTMLInputElement||this._selectedElement instanceof HTMLTextAreaElement){let e="";return this._selectedElement.labels.forEach((t=>e+=t.textContent.trim())),`<code>${e}</code>`}return this._selectedElement instanceof HTMLElement?`<code>${this._selectedElement.innerText}</code>`:"<em>no text selected, yet</em>"}trackSelectedText(){if(this._selectedElement instanceof HTMLElement){if(this._selector=l(this._selectedElement),this._selectedElement instanceof HTMLSelectElement){const e=this._selectedElement.selectedIndex+1;this._selector=`${this._selector} option:nth-child(${e})`}console.log("selector",this._selector)}else console.log("invalid selector")}}customElements.define("text-tracker",k)}();
